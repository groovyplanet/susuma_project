<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.susuma.board.model.BoardMapper">

	<!-- [1] 게시물 목록 -->
	<select id="selectBoards" parameterType="map" resultType="com.susuma.board.model.BoardDTO">
		SELECT B.BO_NO, B.ME_NO, B.TYPE, B.TITLE, B.CONTENT, B.INSERT_TIME, B.UPDATE_TIME, B.ANSWER, B.ANSWER_INSERT_TIME, B.ANSWER_UPDATE_TIME
				, M.NAME 
		FROM 	BOARD B
		JOIN 	MEMBER M 
		ON 		M.ME_NO = B.ME_NO
		WHERE B.TYPE = #{type}
		<if test="answerCheck != NULL and answerCheck.equals('yes')">
			AND B.ANSWER IS NOT NULL
		</if>
		<if test="answerCheck != NULL and answerCheck.equals('no')">
			AND B.ANSWER IS NULL
		</if>
		ORDER BY B.${sortField} ${sortOrder} NULLS LAST
	</select>

	<!-- [2] 게시물 -->
	<select id="selectBoard" resultType="com.susuma.board.model.BoardDTO">
		SELECT * FROM BOARD WHERE BO_NO = #{boNo}
	</select>

	<!-- [3] 게시물 등록 -->
	<insert id="insertBoard" parameterType="com.susuma.board.model.BoardDTO">
		INSERT INTO BOARD(BO_NO, ME_NO, TYPE, TITLE, CONTENT)
		VALUES(BOARD_SEQ.NEXTVAL, #{meNo}, #{type}, #{title}, #{content})
	</insert>

	<!-- [4] 게시물 수정 -->
	<update id="updateBoard" parameterType="com.susuma.board.model.BoardDTO">
		UPDATE BOARD SET TITLE=#{title},CONTENT=#{content},UPDATE_TIME=#{updateTime}
		WHERE BO_NO=#{boNo}
	</update>

	<!-- [5] 게시물 삭제 -->
	<delete id="deleteBoard" parameterType="string">
		DELETE FROM BOARD
		WHERE BO_NO = #{boNo}
	</delete>

</mapper>